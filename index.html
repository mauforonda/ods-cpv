<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="generator" content="Observable Framework v1.13.3">
<title>ODS CPV | Indicadores de desarrollo basados en el Censo 2024</title>
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=Source+Serif+4:ital,opsz,wght@0,8..60,200..900;1,8..60,200..900&amp;display=swap" crossorigin>
<link rel="preload" as="style" href="./_observablehq/theme-air,near-midnight,alt,wide.db1cdf55.css">
<link rel="preload" as="style" href="./_observablehq/stdlib/inputs.ea9fd553.css">
<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css2?family=Source+Serif+4:ital,opsz,wght@0,8..60,200..900;1,8..60,200..900&amp;display=swap" crossorigin>
<link rel="stylesheet" type="text/css" href="./_observablehq/theme-air,near-midnight,alt,wide.db1cdf55.css">
<link rel="stylesheet" type="text/css" href="./_observablehq/stdlib/inputs.ea9fd553.css">
<link rel="modulepreload" href="./_observablehq/client.ce20a9f1.js">
<link rel="modulepreload" href="./_observablehq/runtime.e080113b.js">
<link rel="modulepreload" href="./_observablehq/stdlib.73a8ec5a.js">
<link rel="modulepreload" href="./_import/components/indicadores.96f46d3c.js">
<link rel="modulepreload" href="./_npm/d3@7.9.0/e780feca.js">
<link rel="modulepreload" href="./_npm/htl@0.3.1/72f4716c.js">
<link rel="modulepreload" href="./_observablehq/stdlib/inputs.4ef1d259.js">
<link rel="modulepreload" href="./_npm/@observablehq/plot@0.6.17/d761ef9b.js">
<link rel="modulepreload" href="./_npm/topojson-client@3.1.0/edd9ee95.js">
<link rel="modulepreload" href="./_npm/isoformat@0.2.1/18cbf477.js">
<link rel="modulepreload" href="./_npm/d3-array@3.2.4/e93ca09f.js">
<link rel="modulepreload" href="./_npm/d3-axis@3.0.0/0f2de24d.js">
<link rel="modulepreload" href="./_npm/d3-brush@3.0.0/65eb105b.js">
<link rel="modulepreload" href="./_npm/d3-chord@3.0.1/7ef8fb2e.js">
<link rel="modulepreload" href="./_npm/d3-color@3.1.0/aeb57b94.js">
<link rel="modulepreload" href="./_npm/d3-contour@4.0.2/1d2aed74.js">
<link rel="modulepreload" href="./_npm/d3-delaunay@6.0.4/5ced1d52.js">
<link rel="modulepreload" href="./_npm/d3-dispatch@3.0.1/9ba9c7f3.js">
<link rel="modulepreload" href="./_npm/d3-drag@3.0.0/4202580c.js">
<link rel="modulepreload" href="./_npm/d3-dsv@3.0.1/9cffc2bd.js">
<link rel="modulepreload" href="./_npm/d3-ease@3.0.1/cdd7e898.js">
<link rel="modulepreload" href="./_npm/d3-fetch@3.0.1/b4e2ad9a.js">
<link rel="modulepreload" href="./_npm/d3-force@3.0.0/5e804d15.js">
<link rel="modulepreload" href="./_npm/d3-format@3.1.0/86074ef6.js">
<link rel="modulepreload" href="./_npm/d3-geo@3.1.1/40599fb3.js">
<link rel="modulepreload" href="./_npm/d3-hierarchy@3.1.2/e49e792c.js">
<link rel="modulepreload" href="./_npm/d3-interpolate@3.0.1/8d1e5425.js">
<link rel="modulepreload" href="./_npm/d3-path@3.1.0/20d3f133.js">
<link rel="modulepreload" href="./_npm/d3-polygon@3.0.1/7553081f.js">
<link rel="modulepreload" href="./_npm/d3-quadtree@3.0.1/0dfd751c.js">
<link rel="modulepreload" href="./_npm/d3-random@3.0.1/3c90ee06.js">
<link rel="modulepreload" href="./_npm/d3-scale@4.0.2/843b6a76.js">
<link rel="modulepreload" href="./_npm/d3-scale-chromatic@3.1.0/ba24c2e7.js">
<link rel="modulepreload" href="./_npm/d3-selection@3.0.0/4d94e5b7.js">
<link rel="modulepreload" href="./_npm/d3-shape@3.2.0/6d3a6726.js">
<link rel="modulepreload" href="./_npm/d3-time@3.1.0/9f03c579.js">
<link rel="modulepreload" href="./_npm/d3-time-format@4.1.0/07c9626f.js">
<link rel="modulepreload" href="./_npm/d3-timer@3.0.1/b58a267d.js">
<link rel="modulepreload" href="./_npm/d3-transition@3.0.1/004da2ac.js">
<link rel="modulepreload" href="./_npm/d3-zoom@3.0.0/b5786b3f.js">
<link rel="modulepreload" href="./_npm/interval-tree-1d@1.0.4/53fe8176.js">
<link rel="modulepreload" href="./_npm/internmap@2.0.3/e08981d9.js">
<link rel="modulepreload" href="./_npm/delaunator@5.0.1/02d43215.js">
<link rel="modulepreload" href="./_npm/binary-search-bounds@2.0.5/cbf6ba23.js">
<link rel="modulepreload" href="./_npm/robust-predicates@3.0.2/aa00730b.js">
<link rel="icon" href="https://mauforonda.github.io/images/icon.svg" type="image/svg" sizes="32x32">
<script type="module">

import {define} from "./_observablehq/client.ce20a9f1.js";
import {registerFile} from "./_observablehq/stdlib.73a8ec5a.js";

registerFile("./municipios.json", {"name":"./municipios.json","mimeType":"application/json","path":"./_file/municipios.c9eb137b.json","lastModified":1764052604944,"size":184233});

define({id: "0120886a", inputs: ["d3"], outputs: ["indicadores","datos"], body: (d3) => {
// Cargar datDatos de indicadoreos

// Definiciones de indicadores
const indicadores = d3.json(
  "https://raw.githubusercontent.com/mauforonda/ods-cpv/refs/heads/main/indicadores.json"
);

// Valores de indicadores por municipio
const datos = (async () => {
  const raw = await d3.csv(
    "https://raw.githubusercontent.com/mauforonda/ods-cpv/refs/heads/main/datos.csv",
    d3.autoType
  );
  return raw.reduce((acc, obj) => {
    const munId = obj.id_municipio;

    if (!acc[munId]) {
      acc[munId] = {
        municipio: {
          departamento: obj.departamento,
          provincia: obj.provincia,
          municipio: obj.municipio,
        },
      };
    }

    ["2012", "2024"].forEach((year) => {
      if (obj[year] !== undefined) {
        if (!acc[munId][year]) acc[munId][year] = {};
        acc[munId][year][obj.indicador] = obj[year];
      }
    });

    return acc;
  }, {});
})();
return {indicadores,datos};
}});

define({id: "4fc3cdab", outputs: ["definiciones"], body: async () => {
const {definiciones} = await import("./_import/components/indicadores.96f46d3c.js");

return {definiciones};
}});

define({id: "e3ce09ff", inputs: ["FileAttachment","topojson","datos","d3"], outputs: ["features","colors"], body: (FileAttachment,topojson,datos,d3) => {
// GeometrÃ­as de municipios
const features = (async () => {
  const topo = await FileAttachment("./municipios.json").json();
  const municipios = topojson.feature(topo, topo.objects.mun);
  const validos = Object.keys(datos).map((d) => Number(d));
  municipios.features.forEach((feature) => {
    feature.properties = {
      ...feature.properties,
      centroid: d3.geoCentroid(feature),
    };
    feature.id = Number(feature.properties.codigo);
  });
  municipios.features = municipios.features.filter((d) =>
    validos.includes(d.id)
  );
  return municipios;
})();

const colors = {
  frame: {
    background: "#fff",
    light: "#c6c6c6",
    mid: "#919191",
    dark: "#111111",
  },
  fill: {
    lighter: "#e8f3ff",
    light: "#b2d5f9",
    dark: "#4c97f4",
  },
  map: {
    linear: "GnBu",
    diverging: "BuYlRd",
    a: ["#dfe8f3", "#a5d7ea", "#5ec7cd", "#27b598", "#3b9d50", "#0bdbab"],
  },
};
return {features,colors};
}});

define({id: "04e18386", inputs: ["Inputs","indicadores","definiciones","Generators"], outputs: ["indicador_input","indicador"], body: (Inputs,indicadores,definiciones,Generators) => {
const indicador_input = Inputs.select(Object.keys(indicadores), {
  format: (d) => definiciones[d].abreviacion,
});
const indicador = Generators.input(indicador_input);
return {indicador_input,indicador};
}});

define({id: "20fa5508", inputs: ["definiciones","indicador"], outputs: ["definicion","anio"], body: (definiciones,indicador) => {
const definicion = definiciones[indicador];
const anio = 2024;
return {definicion,anio};
}});

define({id: "1621f036", inputs: ["Plot","features","definicion","datos","anio","indicador","colors","Generators"], outputs: ["mapa_actual","municipio"], body: (Plot,features,definicion,datos,anio,indicador,colors,Generators) => {
const mapa_actual = Plot.plot({
  marginTop: 30,
  marginBottom: 0,
  height: 500,
  width: 500,

  projection: {
    type: "mercator",
    domain: features,
  },
  color: {
    range: definicion.colormap,
    domain: definicion.domain,
    interpolate: "hcl",
  },

  marks: [
    Plot.geo(features.features, {
      fill: (d) => datos[d.id][anio][indicador],
      fillOpacity: 0.8,
      stroke: colors.frame.background,
      strokeWidth: 0.4,
    }),

    Plot.geo(
      features.features,
      Plot.pointer(
        Plot.centroid({
          fill: (d) => datos[d.id][anio][indicador],
          stroke: colors.frame.background,
          strokeWidth: 2.5,
        })
      )
    ),
  ],
});
const municipio = Generators.input(mapa_actual);
return {mapa_actual,municipio};
}});

define({id: "cfb5db08", inputs: ["Plot","definicion","d3"], outputs: ["leyenda_lineal"], body: (Plot,definicion,d3) => {
function leyenda_lineal() {
  return Plot.legend({
    opacity: 0.8,
    margin: 0,
    color: {
      type: "linear",
      interpolate: "hcl",
      range: definicion.colormap,
      domain: definicion.domain,
      tickFormat: d3.format(definicion.format),
    },
  });
}
return {leyenda_lineal};
}});

define({id: "fda0e25d", inputs: ["datos","indicador","htl"], outputs: ["mensaje_actual"], body: (datos,indicador,htl) => {
function mensaje_actual(municipio) {
  if (municipio) {
    const valor = datos[municipio.id][2024][indicador];
    const meta = datos[municipio.id].municipio;
    return htl.html`<mensaje>
      <valor>${valor}</valor>
      <municipio>${meta.municipio}</municipio>
      <departamento>${meta.departamento}</departamento>
    </mensaje>`;
  } else {
    return htl.html`<mensaje></mensaje>`;
  }
}
return {mensaje_actual};
}});

define({id: "ff13d4c3", mode: "inline", inputs: ["indicador_input","display"], body: async (indicador_input,display) => {
display(await(
indicador_input
))
}});

define({id: "a514b67d", mode: "inline", inputs: ["definicion","display"], body: async (definicion,display) => {
display(await(
definicion.abreviacion
))
}});

define({id: "9b2015d1", mode: "inline", inputs: ["definicion","display"], body: async (definicion,display) => {
display(await(
definicion.texto
))
}});

define({id: "599f4817", mode: "inline", inputs: ["leyenda_lineal","display"], body: async (leyenda_lineal,display) => {
display(await(
leyenda_lineal()
))
}});

define({id: "518900e1", mode: "inline", inputs: ["mapa_actual","display"], body: async (mapa_actual,display) => {
display(await(
mapa_actual
))
}});

define({id: "21ef826d", mode: "inline", inputs: ["mensaje_actual","municipio","display"], body: async (mensaje_actual,municipio,display) => {
display(await(
mensaje_actual(municipio)
))
}});

</script>
</head>
<body>
<div id="observablehq-center">
<main id="observablehq-main" class="observablehq">
<link rel="stylesheet" type="text/css" href="./_file/index.70ec54a7.css">
<div class="observablehq observablehq--block"><!--:0120886a:--></div>
<div class="observablehq observablehq--block"><!--:4fc3cdab:--></div>
<div class="observablehq observablehq--block"><!--:e3ce09ff:--></div>
<div class="observablehq observablehq--block"><!--:04e18386:--></div>
<div class="observablehq observablehq--block"><!--:20fa5508:--></div>
<div class="observablehq observablehq--block"><!--:1621f036:--></div>
<div class="observablehq observablehq--block"><!--:cfb5db08:--></div>
<div class="observablehq observablehq--block"><!--:fda0e25d:--></div>
<menu>
  <titulo>Indicadores de desarrollo basados en el Censo 2024</titulo>
  <observablehq-loading></observablehq-loading><!--:ff13d4c3:-->
</menu>
<card>
  <header>
    <titulo><observablehq-loading></observablehq-loading><!--:a514b67d:--></titulo>
    <subtitulo><observablehq-loading></observablehq-loading><!--:9b2015d1:--></subtitulo>
  </header>
  <estado>
    <titulo>en 2024</titulo>
    <leyenda><observablehq-loading></observablehq-loading><!--:599f4817:--></leyenda>
    <mapa>
      <observablehq-loading></observablehq-loading><!--:518900e1:-->
      <observablehq-loading></observablehq-loading><!--:21ef826d:-->
    </mapa>
  </estado>
</card></main>
</div>
</body>
</html>
